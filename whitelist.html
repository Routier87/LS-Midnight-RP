<?php

$webhook_url = "https://discord.com/api/webhooks/1463651535115391220/FWeJRwU_rJQCXbpVixEL6gWp6CHpLE93jxdu9YEgJlGHUM9Cg5DTxgBJyUhupfnGw_Ij";

function field($name) {
    return isset($_POST[$name]) && $_POST[$name] !== "" ? htmlspecialchars($_POST[$name]) : "Non renseign√©";
}

$origine = isset($_POST['origine']) ? implode(", ", $_POST['origine']) : "Non renseign√©";

$message = "**üìù Nouvelle candidature ‚Äì LS Midnight RP**\n\n"
. "**üìå Informations g√©n√©rales**\n"
. "üìß Email : " . field("email") . "\n"
. "üéÆ Discord : " . field("discord") . "\n"
. "üéÇ √Çge IRL : " . field("age_irl") . "\n"
. "‚è∞ Disponibilit√©s : " . field("disponibilites") . "\n\n"

. "**üë§ Identit√© RP**\n"
. "ü™™ Nom RP : " . field("nom_rp") . "\n"
. "üë§ Pr√©nom RP : " . field("prenom_rp") . "\n"
. "üé≠ √Çge RP : " . field("age_rp") . "\n\n"

. "**üìñ Pr√©sentation & Background**\n"
. "üß† Pr√©sentation RP :\n" . field("presentation_rp") . "\n\n"
. "üìö Background RP :\n" . field("background_rp") . "\n\n"
. "üéØ Objectifs RP :\n" . field("objectifs_rp") . "\n\n"

. "**üé≠ Exp√©rience RP**\n"
. "RP d√©j√† pratiqu√© : " . field("experience_rp") . "\n"
. "Serveurs RP : " . field("serveurs_rp") . "\n"
. "Anciennet√© RP : " . field("anciennete_rp") . "\n\n"

. "**üìú R√®glement**\n"
. "R√®glement compris : " . field("reglement") . "\n"
. "D√©finition du RP s√©rieux :\n" . field("rp_serieux") . "\n\n"

. "**üß† Mises en situation**\n"
. "Insultes RP :\n" . field("situation_insulte") . "\n\n"
. "Fail RP :\n" . field("situation_failrp") . "\n\n"

. "**üåê Divers**\n"
. "Origine : " . $origine . "\n"
. "Pourquoi l‚Äôaccepter :\n" . field("pourquoi");

$data = [
    "content" => $message
];

$options = [
    "http" => [
        "header"  => "Content-Type: application/json",
        "method"  => "POST",
        "content" => json_encode($data)
    ]
];

$context = stream_context_create($options);
file_get_contents($webhook_url, false, $context);

// Redirection apr√®s envoi
header("Location: merci.html");
exit;
